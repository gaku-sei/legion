openapi: 3.0.3
info:
  title: "Editor API"
  description: "The OpenAPI specification for the Legion Labs editor."
  version: 1.0.0
paths:
  /v1/spaces/{space-id}/workspaces/{workspace-id}/editor/undo/{transaction-id}:
    parameters:
      - $ref: "../../lgn-governance/apis/space.yaml#/components/parameters/space_id"
      - $ref: "../../lgn-governance/apis/workspace.yaml#/components/parameters/workspace_id"
      - $ref: "#/components/parameters/transaction_id"
    post:
      description: Undo transaction.
      operationId: UndoTransaction
      responses:
        "204":
          description: Ok.
        "409":
          description: Undo transaction failed
  /v1/spaces/{space-id}/workspaces/{workspace-id}/editor/redo/{transaction-id}:
    parameters:
      - $ref: "../../lgn-governance/apis/space.yaml#/components/parameters/space_id"
      - $ref: "../../lgn-governance/apis/workspace.yaml#/components/parameters/workspace_id"
      - $ref: "#/components/parameters/transaction_id"
    post:
      description: Redo transaction.
      operationId: RedoTransaction
      responses:
        "204":
          description: Ok.
        "409":
          description: Redo transaction failed
  /v1/spaces/{space-id}/workspaces/{workspace-id}/editor/messages:
    parameters:
      - $ref: "../../lgn-governance/apis/space.yaml#/components/parameters/space_id"
      - $ref: "../../lgn-governance/apis/workspace.yaml#/components/parameters/workspace_id"
    get:
      description: Get messages from the server (using long polling)
      operationId: getMessages
      responses:
        "200":
          description: New message delivered.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Message"
        "204":
          description: No messages to deliver

components:
  parameters:
    transaction_id:
      name: transaction-id
      in: path
      description: The transaction identifier.
      required: true
      schema:
        $ref: "#/components/schemas/TransactionId"
  schemas:
    TransactionId:
      description: An identifier to a unique a transaction.
      type: string
    Message:
      description: A message coming from the server
      type: object
      properties:
          msg_type:
            type: string
            enum:
              - SelectionChanged
              - ResourceChanged
          payload:
            type: string
      required:
        - payload
        - msg_type
